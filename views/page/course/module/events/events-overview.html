{% from "table/macro.njk" import govukTable %}
{% from "input/macro.njk" import govukInput %}
{% from "button/macro.njk" import govukButton %}
{% from "../../../../component/menu/macro.njk" import menu %}

{% extends "../../../../component/Page.njk" %}

{% block pageTitle %}{{ i18n['event_overview'] }} - {{ i18n['proposition_name'] }}{% endblock %}

{% set banner = true %}
{% set backButton = "/content-management/courses/" + course.id + "/overview" %}

{% block content %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
      <h1 class="govuk-heading-l no-margin">{{ eventDateWithMonthAsText }}, {{ event.venue.location }}</h1>
    </div>
  </div>
     <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
          <p class="govuk-body">This event is for the <strong>{{module.title | default("Module title", true)}}</strong> module on the <a href="/content-management/courses/{{course.id}}/overview" class="govuk-link">{{course.title}}</a> course</p>
          <div class="event-overview">
            <h3 class="govuk-heading-m">Event overview</h3>
              {{ govukTable({
                firstCellIsHeader: true,
                classes: "course-table",
                rows: [
                  [
                    {
                      text: "Added on"
                    },
                    {
                      text: "11 September 2018",
                      format: "numeric"
                    }
                  ],
                  [
                    {
                      text: "Added by"
                    },
                    {
                      text: "course-manager@domain.com",
                      format: "numeric"
                    }
                  ],
                  [
                    {
                      text: "Number of spaces"
                    },
                    {
                      text: event.venue.capacity,
                      format: "numeric"
                    }
                  ],
                  [
                      {
                        text: "Minimum capacity"
                      },
                      {
                        text: event.venue.minCapacity,
                        format: "numeric"
                      }
                  ],
                  [
                    {
                      text: "Event reminder"
                    },
                    {
                      text: "14 days",
                      format: "numeric"
                    }
                  ],
                  [
                    {
                      text: "Town/city"
                    },
                    {
                      text: event.venue.location,
                      format: "numeric"
                    }
                  ],
                  [
                    {
                      text: "Venue address"
                    },
                    {
                      text: event.venue.address,
                      format: "numeric"
                    }
                  ]
                ]
              }) }}
            </div>
            <div class="course-attendees">
              <h3 class="govuk-heading-m">Course attendees</h3>
              {% if eventRecord.length > 0 %}
                <ul class="attendees headers">
                  <li class="list-headers"><p class="govuk-body header title"><strong>Name</strong></p><p class="govuk-body header payment"><strong>Payment</strong></p><span class="button-header"></span></li>
                </ul>
                <ul class="attendees list">
                  {% for attendee in eventRecord %}
                      {% if attendee.status === 0 %}
                        {% set payment = "Booked" %}
                      {% elif attendee.status === 1 %}
                        {% set payment = "Cancelled" %}
                      {% elif attendee.status === 2 %} 
                         {% set payment = "Pending" %}
                      {% endif %}
                      <li class="list-details"><p class="govuk-body title">{{ attendee.delegateEmailAddress}}</p><p class="govuk-body payment">{{ payment }}</p><p class="buttons govuk-body"><a class="govuk-link" href="#">View</a></p></li>
                  {% endfor %}
                </ul>
              {% else %}
                <p class="govuk-body">This course doesn't have any attendees yet.</p>
              {% endif %}
            </div>
            <div class="add-attendee">
              <form action="/content-management/courses/{{course.id}}/modules/{{module.id}}/events/{{event.id}}/invite" method="post" class="attendee-form">
                <div class="input-with-button">
                  {{ govukInput({
                    label: {
                      text: "Add an attendee with their email address"
                    },
                    id: "user",
                    name: "user"
                  }) }}
                  {{ govukButton({
                    text: "Search for user",
                    classes: "button-blue"
                  }) }}
                  </div>
              </form>
            </div>
        </div>
        <div class="govuk-grid-column-one-third">
          <div class="right-menu">
                {% block menu %}
                {% set actions = [
                        {
                            link: '/content-management/courses/' + course.id + '/modules/' + module.id + '/events/' + event.id + '/dateRanges/',
                            text: 'Edit time and date'
                        },
                        {
                            link: '/content-management/courses/' + course.id + '/modules/' + module.id + '/events/' + event.id + '/location/',
                            text: 'Edit location and capacity'
                        },
                        {
                            link: '#',
                            text: 'Edit reminder time'
                        },
                        {
                            link: '#',
                            text: 'Prevent further signups'
                        },
                        {
                            link: '#',
                            text: 'Cancel this event'
                        }
                    ] %}
                    {{ menu("Actions", actions) }}
                {% endblock %}
            </div>
        </div>
     </div>
  </div>
{% endblock %}
